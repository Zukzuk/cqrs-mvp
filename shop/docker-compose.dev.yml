services:
  shop-webserver-dev:
    image: cqrs-mvp/base:latest
    working_dir: /usr/src
    volumes:
      - ./:/usr/src
      - /usr/src/node_modules # keep container's node_modules, avoids ENOTEMPTY
    environment:
      - CHOKIDAR_USEPOLLING=true
      - SHOP_WEB_DEV_PORT=5173
    ports:
      - "${SHOP_WEB_DEV_PORT:-5173}:5173"
    command: >
      sh -lc "npm run dev --workspace shop/shop-webserver -- --host 0.0.0.0 --port 5173"
    profiles: ["webdev"]
